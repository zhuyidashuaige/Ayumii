<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">❤ Ruang belajar eksklusif Ayumiiisaa ❤</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- 新增：浪漫手写标题字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&display=swap" rel="stylesheet">
</head>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // 仅首次打开显示（按浏览器持久化记录），如需“每次刷新首次”可改为 sessionStorage
    if (!localStorage.getItem('lovePopupShown')) {
      showLovePopup();
    }
  });

  function showLovePopup() {
    // 创建覆盖层与弹窗
    const overlay = document.createElement('div');
    overlay.id = 'lovePopupOverlay';
    overlay.innerHTML = `
      <div class="love-popup">
        <img src="love.gif" alt="love" />
      </div>
    `;
    document.body.appendChild(overlay);

    // 注入样式（只注入一次）
    if (!document.querySelector('style[data-love-popup]')) {
      const style = document.createElement('style');
      style.setAttribute('data-love-popup', 'true');
      style.textContent = `
        #lovePopupOverlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.45);
          backdrop-filter: blur(2px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 9999;
          animation: popupFadeIn 0.25s ease;
        }
        .love-popup {
          background: #ffffff;
          border-radius: 12px;
          padding: 10px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
          max-width: 90vw;
          max-height: 90vh;
          animation: popupScaleIn 0.25s ease;
        }
        .love-popup img {
          display: block;
          width: 320px;
          height: auto;
          max-width: 80vw;
          max-height: 80vh;
          border-radius: 8px;
        }
        @media (max-width: 480px) {
          .love-popup img { width: 240px; }
        }
        @keyframes popupFadeIn {
          from { opacity: 0; } to { opacity: 1; }
        }
        @keyframes popupScaleIn {
          from { transform: scale(0.95); opacity: 0.9; }
          to   { transform: scale(1); opacity: 1; }
        }
      `;
      document.head.appendChild(style);
    }

    // 点击任意位置关闭（包括图片本身）
    const close = () => {
      localStorage.setItem('lovePopupShown', '1');
      overlay.remove();
    };
    overlay.addEventListener('click', close, { once: true });
  }
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    showRomanticLovePopup(); // 无条件显示
  });

  function showRomanticLovePopup() {
    const overlay = document.createElement('div');
    overlay.id = 'loveOverlay';
    overlay.innerHTML = `
      <div class="love-card" role="dialog" aria-modal="true" aria-label="Romantic Welcome">
        <div class="love-header">
          <span class="love-heart">❤</span>
          <span class="love-title">For my dearest Ayumiiisaa</span>
          <span class="love-heart">❤</span>
        </div>
        <div class="love-media">
          <img src="love.gif" alt="love">
        </div>
        <div class="love-text">Pelukan itu hal yang paling romantis, kan? Aku ingin memelukmu seumur hidup, seperti foto ini.</div>
        <div class="love-hint">Klik di mana saja untuk menutup ✨</div>
      </div>
    `;
    document.body.appendChild(overlay);

    // 点击任意处优雅关闭
    const close = () => {
      overlay.classList.add('love-exit');
      setTimeout(() => overlay.remove(), 200);
    };
    overlay.addEventListener('click', close, { once: true });
  }
</script>
<body>
    <!-- 新增：漂浮爱心背景 -->
    <div class="romance-hearts" aria-hidden="true">
        <span></span><span></span><span></span><span></span><span></span><span></span>
        <span></span><span></span><span></span><span></span><span></span><span></span>
    </div>
    <div class="container">
        <header class="header">
            <div class="back-button hidden" id="backButton" onclick="goBack()">
                <span>← Kembali ke Daftar Isi</span>
            </div>
            <h1 class="title" id="mainTitle">❤ Ruang belajar eksklusif Ayumiiisaa ❤</h1>
            <p class="subtitle" id="mainSubtitle">0,99³⁶⁵ = 0,03 &nbsp;&nbsp;&nbsp;
1,01³⁶⁵ = 37,8&nbsp;&nbsp;&nbsp;
Lakukan sedikit kemajuan setiap hari dan Anda akan menjadi pegawai negeri sipil.</p>

            <!-- 新增：目录搜索 -->
            <div class="search-bar">
                <div class="search-input-wrap">
                    <input id="dirSearch" type="text" placeholder="Cari proyek atau direktori" autocomplete="off">
                    <button id="clearSearch" title="清空">✕</button>
                </div>
                <div class="search-results hidden" id="searchResults"></div>
            </div>
        </header>
        
        <main class="main-content" id="mainContent">
            <!-- 主页科目选择 -->
            <div class="subject-grid" id="subjectGrid">
                <div class="subject-card" onclick="goToSubject('Teori Bilangan', '数论')">
                    <div class="subject-icon">🔢</div>
                    <h3>Teori Bilangan</h3>
                    <p>数论</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Operasi Bilangan Pecahan', '分数运算')">
                    <div class="subject-icon">➗</div>
                    <h3>Operasi Bilangan Pecahan</h3>
                    <p>分数运算</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Persentase', '百分比')">
                    <div class="subject-icon">📊</div>
                    <h3>Persentase</h3>
                    <p>百分比</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Perbandingan', '比与比例')">
                    <div class="subject-icon">⚖️</div>
                    <h3>Perbandingan</h3>
                    <p>比与比例</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Waktu, Jarak dan Kecepatan', '时间、距离、速度')">
                    <div class="subject-icon">🚀</div>
                    <h3>Waktu, Jarak dan Kecepatan</h3>
                    <p>时间、距离、速度</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Waktu, Jarak dan Kecepatan 2', '时间、距离、速度 2')">
                    <div class="subject-icon">🏃</div>
                    <h3>Waktu, Jarak dan Kecepatan 2</h3>
                    <p>时间、距离、速度 2</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Aritmetika Sosial', '社会算术（折扣、利润等）')">
                    <div class="subject-icon">💰</div>
                    <h3>Aritmetika Sosial</h3>
                    <p>社会算术（折扣、利润等）</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Tabel dan Diagram', '表格与图表')">
                    <div class="subject-icon">📈</div>
                    <h3>Tabel dan Diagram</h3>
                    <p>表格与图表</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Mean, Median, Modus dan Range', '平均数、中位数、众数、极差')">
                    <div class="subject-icon">📊</div>
                    <h3>Mean, Median, Modus dan Range</h3>
                    <p>平均数、中位数、众数、极差</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Sinonim/Persamaan Kata', '近义词')">
                    <div class="subject-icon">📝</div>
                    <h3>Sinonim/Persamaan Kata</h3>
                    <p>近义词</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Sinonim 2', '近义词 2')">
                    <div class="subject-icon">✍️</div>
                    <h3>Sinonim 2</h3>
                    <p>近义词 2</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Kumpulan Sinonim Kata', '近义词汇总')">
                    <div class="subject-icon">📚</div>
                    <h3>Kumpulan Sinonim Kata</h3>
                    <p>近义词汇总</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Antonim/Lawan Kata', '反义词')">
                    <div class="subject-icon">🔄</div>
                    <h3>Antonim/Lawan Kata</h3>
                    <p>反义词</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Antonim 2', '反义词 2')">
                    <div class="subject-icon">🔃</div>
                    <h3>Antonim 2</h3>
                    <p>反义词 2</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Kumpulan Antonim Kata', '反义词汇总')">
                    <div class="subject-icon">📖</div>
                    <h3>Kumpulan Antonim Kata</h3>
                    <p>反义词汇总</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Analogi/Relasi Makna', '语义类比')">
                    <div class="subject-icon">🧩</div>
                    <h3>Analogi/Relasi Makna</h3>
                    <p>语义类比</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Analogi Kata 2', '语义类比 2')">
                    <div class="subject-icon">🎯</div>
                    <h3>Analogi Kata 2</h3>
                    <p>语义类比 2</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Pengelompokan Kata', '词语归类')">
                    <div class="subject-icon">🗂️</div>
                    <h3>Pengelompokan Kata</h3>
                    <p>词语归类</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Pemahaman Bacaan', '阅读理解')">
                    <div class="subject-icon">📖</div>
                    <h3>Pemahaman Bacaan</h3>
                    <p>阅读理解</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Aljabar, Pangkat dan Akar', '代数、幂与根')">
                    <div class="subject-icon">🔢</div>
                    <h3>Aljabar, Pangkat dan Akar</h3>
                    <p>代数、幂与根</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Persamaan Linear Satu Variabel dan Aplikasinya', '一元一次方程及其应用')">
                    <div class="subject-icon">📐</div>
                    <h3>Persamaan Linear Satu Variabel dan Aplikasinya</h3>
                    <p>一元一次方程及其应用</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Persamaan Linier Dua Variabel dan Aplikasinya', '二元一次方程及其应用')">
                    <div class="subject-icon">📏</div>
                    <h3>Persamaan Linier Dua Variabel dan Aplikasinya</h3>
                    <p>二元一次方程及其应用</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Persamaan Linear Tiga Variabel dan Aplikasinya', '三元一次方程及其应用')">
                    <div class="subject-icon">📊</div>
                    <h3>Persamaan Linear Tiga Variabel dan Aplikasinya</h3>
                    <p>三元一次方程及其应用</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Persamaan Kuadrat', '二次方程')">
                    <div class="subject-icon">🔺</div>
                    <h3>Persamaan Kuadrat</h3>
                    <p>二次方程</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Aritmetika dan Geometri', '算术与几何')">
                    <div class="subject-icon">📐</div>
                    <h3>Aritmetika dan Geometri</h3>
                    <p>算术与几何</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Bangun Datar', '平面几何')">
                    <div class="subject-icon">🔷</div>
                    <h3>Bangun Datar</h3>
                    <p>平面几何</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Bangun Ruang', '立体几何')">
                    <div class="subject-icon">🧊</div>
                    <h3>Bangun Ruang</h3>
                    <p>立体几何</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Eksponen Lanjutan dan Persamaannya', '指数进阶及其方程')">
                    <div class="subject-icon">⚡</div>
                    <h3>Eksponen Lanjutan dan Persamaannya</h3>
                    <p>指数进阶及其方程</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Himpunan', '集合')">
                    <div class="subject-icon">🎯</div>
                    <h3>Himpunan</h3>
                    <p>集合</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Teori Peluang, Permutasi dan Kombinasi', '概率、排列与组合')">
                    <div class="subject-icon">🎲</div>
                    <h3>Teori Peluang, Permutasi dan Kombinasi</h3>
                    <p>概率、排列与组合</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Deret Angka dan Huruf', '数字与字母数列')">
                    <div class="subject-icon">🔢</div>
                    <h3>Deret Angka dan Huruf</h3>
                    <p>数字与字母数列</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Deret Gambar', '图形数列')">
                    <div class="subject-icon">🖼️</div>
                    <h3>Deret Gambar</h3>
                    <p>图形数列</p>
                </div>
                <div class="subject-card" onclick="goToSubject('Sudut, Garis dan Kesebangunan', '角、直线与相似（形）')">
                    <div class="subject-icon">📐</div>
                    <h3>Sudut, Garis dan Kesebangunan</h3>
                    <p>角、直线与相似（形）</p>
                </div>
                <div class="subject-card" onclick="goToSubject('exam', '考试')">
                    <div class="subject-icon">📝</div>
                    <h3>Exam</h3>
                    <p>考试</p>
                </div>
                <div class="subject-card" onclick="showRelaxMenu()">
                    <div class="subject-icon">⌨</div>
                    <h3>Relax</h3>
                    <p>放松一下</p>
                </div>
            </div>
            
            <!-- 子目录选择 -->
            <div class="menu-section hidden" id="subMenu">
                <div class="sub-menu-grid">
                    <div class="sub-menu-card" onclick="showContent('基础知识')">
                        <div class="sub-icon">📚</div>
                        <h3>Dasar-dasar</h3>
                    </div>
                    <div class="sub-menu-card" onclick="showContent('课堂作业')">
                        <div class="sub-icon">✏️</div>
                        <h3>Pekerjaan Kelas</h3>
                    </div>
                    <div class="sub-menu-card" onclick="showContent('课后作业')">
                        <div class="sub-icon">📝</div>
                        <h3>Pekerjaan rumah</h3>
                    </div>
                </div>
            </div>

            <!-- Relax 专用子菜单 -->
            <div class="menu-section hidden" id="relaxMenu">
                <div class="sub-menu-grid">
                    <div class="sub-menu-card" onclick="openExternalLink('https://zhuyidashuaige.github.io/Ayumii/interesting%20page/helicopter.html')">
                        <div class="sub-icon">🚁</div>
                        <h3>Helicopter</h3>
                    </div>
                    <div class="sub-menu-card" onclick="openExternalLink('https://zhuyidashuaige.github.io/Ayumii/interesting%20page/fire%20dragon.html')">
                        <div class="sub-icon">🐉</div>
                        <h3>Fire Dragon</h3>
                    </div>
                    <div class="sub-menu-card" onclick="openExternalLink('https://zhuyidashuaige.github.io/Ayumii/interesting%20page/sea_and_sky.html')">
                        <div class="sub-icon">🏖️</div>
                        <h3>sea and sky</h3>
                    </div>
                    <div class="sub-menu-card" onclick="openExternalLink('https://zhuyidashuaige.github.io/Ayumii/interesting%20page/love_mooncake.html')">
                        <div class="sub-icon">🥮</div>
                        <h3>love mooncake</h3>
                    </div>
                    <div class="sub-menu-card" onclick="openExternalLink('https://zhuyidashuaige.github.io/Ayumii/interesting%20page/fish.html')">
                        <div class="sub-icon">🐟</div>
                        <h3>go fishing~</h3>
                    </div>
                </div>
            </div>
            
            <!-- 内容展示区 -->
            <div class="content-section hidden" id="contentSection">
                <div class="back-button" onclick="showSubMenu()">
                    <span>← kembali</span>
                </div>
                <h2 class="content-title" id="contentTitle"></h2>
                <div class="image-gallery" id="imageGallery">
                    <!-- 图片将在这里动态加载 -->
                </div>
            </div>
        </main>
    </div>
    
    <script>
        let currentSubject = '';
        let currentChineseName = '';
        let currentCategory = '';
        
        // 页面初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 添加动画效果
            const cards = document.querySelectorAll('.subject-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.05}s`;
                card.classList.add('fade-in-up');
            });
            
            // 添加触摸支持
            if ('ontouchstart' in window) {
                document.body.classList.add('touch-device');
            }

            // 新增：构建搜索索引与绑定事件
            buildSearchIndex();
            bindSearchEvents();
        });

        // 新增：目录搜索相关
        // 将原先的 const CATEGORIES = ['基础知识','课堂作业','课后作业']; 替换为中印对照表
        const CATEGORY_MAP = [
            { zh: '基础知识',  id: 'Dasar-dasar' },
            { zh: '课堂作业',  id: 'Pekerjaan Kelas' },
            { zh: '课后作业',  id: 'Pekerjaan rumah' }
        ];
        let searchIndex = [];
        let activeIdx = -1;
    
        function buildSearchIndex() {
            searchIndex = [];
            const cards = document.querySelectorAll('.subject-card');
            cards.forEach(card => {
                const subject = (card.querySelector('h3')?.textContent || '').trim();
                const chinese = (card.querySelector('p')?.textContent || '').trim();
                CATEGORY_MAP.forEach(cat => {
                    searchIndex.push({
                        subject,
                        chinese,
                        categoryZh: cat.zh,   // 用于真实跳转（你的目录是中文）
                        categoryId: cat.id    // 用于下拉显示（印尼文）
                    });
                });
            });
        }

        function normalize(str) {
            return (str || '')
                .toLowerCase()
                .normalize('NFKD')
                .replace(/[\u0300-\u036f]/g, '');
        }

        function matchItem(item, kw) {
            if (!kw) return true;
            const n = normalize(kw);
            return normalize(item.subject).includes(n) ||
                   normalize(item.chinese).includes(n) ||
                   normalize(item.categoryZh).includes(n) ||  // 支持中文目录关键字
                   normalize(item.categoryId).includes(n);    // 也支持印尼文目录关键字
        }

        function renderResults(list, kw) {
            const box = document.getElementById('searchResults');
            if (!kw) {
                box.classList.add('hidden');
                box.innerHTML = '';
                return;
            }
            if (list.length === 0) {
                box.classList.remove('hidden');
                box.innerHTML = `<div class="search-empty">Tidak ada kecocokan yang ditemukan</div>`;
                return;
            }
            const html = list.slice(0, 12).map((it, i) => {
                return `
                    <div class="search-result-item" data-idx="${i}">
                        <span class="badge">目录</span>
                        <div class="label">
                            <strong>${it.subject}</strong> — ${it.chinese} <span style="opacity:.7">› ${it.categoryId}</span>
                        </div>
                    </div>
                `;
            }).join('');
            box.innerHTML = html;
            box.classList.remove('hidden');

            // 点击选择
            Array.from(box.querySelectorAll('.search-result-item')).forEach((el, i) => {
                el.addEventListener('click', () => {
                    const item = list[i];
                    selectResult(item);
                });
            });
        }

        function filterSubjectCards(kw) {
            const cards = document.querySelectorAll('.subject-card');
            cards.forEach(card => {
                const subject = (card.querySelector('h3')?.textContent || '').trim();
                const chinese  = (card.querySelector('p')?.textContent || '').trim();
                const show = !kw || normalize(subject).includes(normalize(kw)) || normalize(chinese).includes(normalize(kw));
                card.style.display = show ? '' : 'none';
            });
        }

        function selectResult(item) {
            // 跳转到科目并直接打开对应目录
            goToSubject(item.subject, item.chinese);
            setTimeout(() => {
                showContent(item.categoryZh);
            }, 0);
            // 清理UI
            const input = document.getElementById('dirSearch');
            input.blur();
            document.getElementById('searchResults').classList.add('hidden');
        }

        function bindSearchEvents() {
            const input = document.getElementById('dirSearch');
            const clearBtn = document.getElementById('clearSearch');
            const resultBox = document.getElementById('searchResults');

            let currentResults = [];

            function update() {
                const kw = input.value.trim();
                filterSubjectCards(kw);
                currentResults = searchIndex.filter(item => matchItem(item, kw));
                activeIdx = -1;
                renderResults(currentResults, kw);
            }

            input.addEventListener('input', update);
            clearBtn.addEventListener('click', () => {
                input.value = '';
                input.focus();
                update();
            });

            // 键盘操作：上下选择、回车确认、ESC 关闭
            input.addEventListener('keydown', (e) => {
                const items = Array.from(resultBox.querySelectorAll('.search-result-item'));
                if (e.key === 'ArrowDown') {
                    if (!items.length) return;
                    activeIdx = (activeIdx + 1) % items.length;
                    items.forEach(el => el.classList.remove('active'));
                    items[activeIdx].classList.add('active');
                    e.preventDefault();
                } else if (e.key === 'ArrowUp') {
                    if (!items.length) return;
                    activeIdx = (activeIdx - 1 + items.length) % items.length;
                    items.forEach(el => el.classList.remove('active'));
                    items[activeIdx].classList.add('active');
                    e.preventDefault();
                } else if (e.key === 'Enter') {
                    if (items.length && activeIdx >= 0) {
                        selectResult(currentResults[activeIdx]);
                    } else if (items.length) {
                        // 没有高亮则默认选择第一项
                        selectResult(currentResults[0]);
                    }
                } else if (e.key === 'Escape') {
                    input.blur();
                    resultBox.classList.add('hidden');
                }
            });

            // 点击外部区域关闭结果
            document.addEventListener('click', (e) => {
                if (!resultBox.contains(e.target) && e.target !== input) {
                    resultBox.classList.add('hidden');
                }
            });
        }
        // 跳转到科目页面（现在改为显示子菜单）
        function goToSubject(subjectName, chineseName) {
            currentSubject = subjectName;
            currentChineseName = chineseName;
            
            // 隐藏主页面，显示子菜单
            document.getElementById('subjectGrid').classList.add('hidden');
            document.getElementById('subMenu').classList.remove('hidden');
            document.getElementById('backButton').classList.remove('hidden');
            
            // 更新页面标题
            document.getElementById('pageTitle').textContent = `${subjectName} - 甜蜜学习之旅`;
            document.getElementById('mainTitle').textContent = `📚 ${subjectName}`;
            document.getElementById('mainSubtitle').textContent = chineseName;
            
            // 添加动画效果
            const subCards = document.querySelectorAll('.sub-menu-card');
            subCards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
                card.classList.add('fade-in-up');
            });
        }
        
        // 返回主目录
        function goBack() {
            document.getElementById('subjectGrid').classList.remove('hidden');
            document.getElementById('subMenu').classList.add('hidden');
            document.getElementById('relaxMenu').classList.add('hidden'); // 新增这行
            document.getElementById('contentSection').classList.add('hidden');
            document.getElementById('backButton').classList.add('hidden');
            
            // 恢复原始标题
            document.getElementById('pageTitle').textContent = '❤ Ruang belajar eksklusif Ayumiiisaa ❤';
            document.getElementById('mainTitle').textContent = '❤ Ruang belajar eksklusif Ayumiiisaa ❤';
            document.getElementById('mainSubtitle').textContent = '0,99³⁶⁵ = 0,03     1,01³⁶⁵ = 37,8     Lakukan sedikit kemajuan setiap hari dan Anda akan menjadi pegawai negeri sipil.';
        }
        
        // 返回子菜单
        function showSubMenu() {
            document.getElementById('subMenu').classList.remove('hidden');
            document.getElementById('contentSection').classList.add('hidden');
        }
        
        // 显示内容
        function showContent(category) {
            currentCategory = category;
            document.getElementById('subMenu').classList.add('hidden');
            document.getElementById('contentSection').classList.remove('hidden');
            document.getElementById('contentTitle').textContent = `${currentSubject} - ${category}`;
            
            loadImages();
        }
        
        // 加载图片
        function loadImages() {
            const gallery = document.getElementById('imageGallery');
            gallery.innerHTML = '<div class="loading">Memuat gambar...</div>';
            
            // 构建图片路径
            const basePath = `资料/${currentSubject}/${currentCategory}`;
            
            // 常见的图片扩展名
            const imageExtensions = ['jpg', 'jpeg', 'png', 'gif', 'webp'];
            const imagePromises = [];
            
            // 尝试加载多个可能的图片文件
            for (let i = 1; i <= 20; i++) {
                for (const ext of imageExtensions) {
                    const imagePath = `${basePath}/${i}.${ext}`;
                    imagePromises.push(checkImageExists(imagePath));
                    
                    // 也尝试一些常见的命名模式
                    const altPaths = [
                        `${basePath}/image${i}.${ext}`,
                        `${basePath}/img${i}.${ext}`,
                        `${basePath}/pic${i}.${ext}`,
                        `${basePath}/${String(i).padStart(2, '0')}.${ext}`
                    ];
                    
                    altPaths.forEach(path => {
                        imagePromises.push(checkImageExists(path));
                    });
                }
            }
            
            Promise.allSettled(imagePromises).then(results => {
                const validImages = results
                    .filter(result => result.status === 'fulfilled' && result.value)
                    .map(result => result.value)
                    .filter((path, index, self) => self.indexOf(path) === index); // 去重
                
                displayImages(validImages);
            });
        }
        
        // 检查图片是否存在
        function checkImageExists(imagePath) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(imagePath);
                img.onerror = () => resolve(null);
                img.src = imagePath;
            });
        }
        
        // 获取文件大小
        function getImageSize(imagePath) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => {
                    // 尝试获取文件大小（这在浏览器中有限制）
                    resolve({
                        width: img.naturalWidth,
                        height: img.naturalHeight,
                        size: '未知大小' // 浏览器安全限制，无法直接获取文件大小
                    });
                };
                img.onerror = () => resolve({ width: 0, height: 0, size: '未知大小' });
                img.src = imagePath;
            });
        }
        
        // 显示图片
        function displayImages(imagePaths) {
            const gallery = document.getElementById('imageGallery');
            
            if (imagePaths.length === 0) {
                gallery.innerHTML = `
                    <div class="error-message">
                        <h3>😔 Belum ada gambar</h3>
                    </div>
                `;
                return;
            }
            
            gallery.innerHTML = '';
            
            imagePaths.forEach((imagePath, index) => {
                const imageItem = document.createElement('div');
                imageItem.className = 'image-item';
                imageItem.style.animationDelay = `${index * 0.1}s`;
                
                // 获取文件名
                const fileName = imagePath.split('/').pop();
                
                imageItem.innerHTML = `
                    <div class="image-container">
                        <img src="${imagePath}" alt="${currentSubject} - ${currentCategory} - ${fileName}" loading="lazy">
                        <div class="image-overlay">
                            <button class="overlay-button" onclick="openImageModal('${imagePath}', '${fileName}')" title="查看大图">
                                👁️
                            </button>
                            <button class="overlay-button" onclick="downloadImage('${imagePath}', '${fileName}')" title="下载图片">
                                📥
                            </button>
                        </div>
                    </div>
                    <div class="image-info">
                        <div class="image-title">${fileName}</div>
                        <div class="image-size" id="size-${index}">加载中...</div>
                    </div>
                `;
                
                gallery.appendChild(imageItem);
                
                // 异步获取图片尺寸信息
                getImageSize(imagePath).then(info => {
                    const sizeElement = document.getElementById(`size-${index}`);
                    if (sizeElement) {
                        sizeElement.textContent = `${info.width} × ${info.height}px`;
                    }
                });
            });
        }
        
        // 下载图片
        function downloadImage(imagePath, fileName) {
            // 创建一个临时的a标签来触发下载
            const link = document.createElement('a');
            link.href = imagePath;
            link.download = fileName;
            link.style.display = 'none';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // 显示下载提示
            showToast(`正在下载: ${fileName}`, 'success');
        }
        
        // 图片模态框功能（增强版）
        function openImageModal(imagePath, fileName) {
            const modal = document.createElement('div');
            modal.className = 'image-modal';
            
            // 获取图片信息
            getImageSize(imagePath).then(info => {
                modal.innerHTML = `
                    <div class="modal-content">
                        <div class="modal-header">
                            <div class="modal-title">${fileName}</div>
                            <div class="modal-actions">
                                <button class="modal-button" onclick="downloadImage('${imagePath}', '${fileName}')">
                                    📥 下载
                                </button>
                                <button class="close-modal" onclick="closeImageModal()">&times;</button>
                            </div>
                        </div>
                        <img src="${imagePath}" alt="${fileName}" class="modal-image">
                        <div class="modal-info">
                            <h3>${currentSubject} - ${currentCategory}</h3>
                            <p>文件名: ${fileName}</p>
                            <p>尺寸: ${info.width} × ${info.height} 像素</p>
                            <p>大小: ${info.size}</p>
                        </div>
                    </div>
                `;
            });
            
            document.body.appendChild(modal);
            
            // 点击背景关闭模态框
            modal.onclick = (e) => {
                if (e.target === modal) {
                    closeImageModal();
                }
            };
            
            // 阻止模态框内容区域的点击事件冒泡
            modal.querySelector('.modal-content').onclick = (e) => {
                e.stopPropagation();
            };
        }
        
        // 关闭图片模态框
        function closeImageModal() {
            const modal = document.querySelector('.image-modal');
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => {
                    modal.remove();
                }, 300);
            }
        }
        
        // 显示提示消息
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            
            // 添加toast样式
            const style = document.createElement('style');
            style.textContent = `
                .toast {
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 12px 20px;
                    border-radius: 25px;
                    color: white;
                    font-weight: 600;
                    z-index: 2000;
                    animation: slideInRight 0.3s ease, fadeOut 0.3s ease 2.7s;
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                }
                
                .toast-success {
                    background: linear-gradient(145deg, #28a745, #20c997);
                }
                
                .toast-info {
                    background: linear-gradient(145deg, #17a2b8, #6f42c1);
                }
                
                .toast-error {
                    background: linear-gradient(145deg, #dc3545, #e83e8c);
                }
                
                @keyframes slideInRight {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
                
                @keyframes fadeOut {
                    from {
                        opacity: 1;
                    }
                    to {
                        opacity: 0;
                    }
                }
            `;
            
            if (!document.querySelector('style[data-toast]')) {
                style.setAttribute('data-toast', 'true');
                document.head.appendChild(style);
            }
            
            document.body.appendChild(toast);
            
            // 3秒后自动移除
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 3000);
        }
        
        // 键盘事件处理
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeImageModal();
            }
        });
        
        // 添加淡入动画样式
        const fadeInStyle = document.createElement('style');
        fadeInStyle.textContent = `
            .fade-in-up {
                animation: fadeInUp 0.6s ease forwards;
                opacity: 0;
                transform: translateY(30px);
            }
            
            @keyframes fadeInUp {
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            @keyframes fadeOut {
                from {
                    opacity: 1;
                    transform: scale(1);
                }
                to {
                    opacity: 0;
                    transform: scale(0.9);
                }
            }
            
            .touch-device .subject-card:hover {
                transform: none;
            }
            
            .touch-device .subject-card:active {
                transform: scale(0.95);
            }
            
            .hidden {
                display: none !important;
            }
        `;
        document.head.appendChild(fadeInStyle);

        // 显示 Relax 专用菜单
        function showRelaxMenu() {
            // 隐藏主页面，显示 Relax 菜单
            document.getElementById('subjectGrid').classList.add('hidden');
            document.getElementById('relaxMenu').classList.remove('hidden');
            document.getElementById('backButton').classList.remove('hidden');
            
            // 更新页面标题
            document.getElementById('pageTitle').textContent = 'Relax - Waktu bersantai';
            document.getElementById('mainTitle').textContent = '🎮 Relax';
            document.getElementById('mainSubtitle').textContent = 'Bersantailah dan pilih permainan favorit Anda';
            
            // 添加动画效果
            const relaxCards = document.querySelectorAll('#relaxMenu .sub-menu-card');
            relaxCards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
                card.classList.add('fade-in-up');
            });
        }

        // 打开外部链接
        function openExternalLink(url) {
            window.open(url, '_blank');
        }
    </script>
</body>
</html>





